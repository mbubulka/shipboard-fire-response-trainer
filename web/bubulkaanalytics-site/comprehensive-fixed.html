<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Shipboard Fire Response Training - Complete DCA Training System</title>
    <script src="dca-feedback-integration.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2980b9 0%, #6bb6ff 50%, #3742fa 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .mission-critical-info {
            background: rgba(255, 193, 7, 0.15);
            border: 2px solid rgba(255, 193, 7, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: left;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .mission-critical-info p {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 15px;
            opacity: 1;
        }
        
        .mission-critical-info strong {
            color: #ffd700;
            font-weight: bold;
        }
        
        .critical-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
            padding: 0 20px;
        }
        
        .stat-item {
            text-align: center;
            background: rgba(220, 53, 69, 0.2);
            border: 2px solid rgba(220, 53, 69, 0.5);
            border-radius: 15px;
            padding: 25px 15px;
            transition: transform 0.3s ease;
        }
        
        .stat-item:hover {
            transform: translateY(-5px);
            background: rgba(220, 53, 69, 0.3);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .stat-label {
            font-size: 0.95rem;
            line-height: 1.4;
            opacity: 0.9;
        }
        
        .training-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .mode-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 30px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            text-decoration: none;
            color: white;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .mode-card:hover {
            background: rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .mode-icon {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .mode-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
            text-align: center;
            color: #ffd700;
        }
        
        .mode-description {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .mode-features {
            list-style: none;
            padding: 0;
        }
        
        .mode-features li {
            padding: 5px 0 5px 20px;
            position: relative;
        }
        
        .mode-features li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
        }
        
        .mode-badge {
            display: inline-block;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-top: 15px;
        }
        
        .training-content {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: none;
        }
        
        .training-content.active {
            display: block;
        }
        
        /* Scenario Interface Styles */
        .scenario-interface {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .scenario-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .scenario-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #ffd700;
        }
        
        .scenario-btn {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }
        
        .scenario-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .scenario-btn.primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }
        
        .scenario-btn.secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
        }
        
        /* Assessment Styles */
        .assessment-interface {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .assessment-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .assessment-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #ffd700;
        }
        
        .assessment-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 8px;
        }
        
        .assessment-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .assessment-btn.primary {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .assessment-btn.secondary {
            background: linear-gradient(45deg, #34495e, #2c3e50);
            color: white;
        }
        
        .assessment-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }
        
        .question-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #ffd700;
        }
        
        .answer-options {
            margin: 30px 0;
        }
        
        .answer-option {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: rgba(52, 73, 94, 0.3);
            border: 2px solid #34495e;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }
        
        .answer-option:hover {
            background: rgba(52, 73, 94, 0.5);
            border-color: #3498db;
        }
        
        .answer-option.selected {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.3);
        }
        
        .option-letter {
            background: #34495e;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .answer-option.selected .option-letter {
            background: #3498db;
        }
        
        .results-card {
            text-align: center;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }
        
        .score-display {
            font-size: 3rem;
            margin: 20px 0;
            color: #2ecc71;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .feedback-message {
            font-size: 1.2rem;
            line-height: 1.6;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
                        <h1>üî• Shipboard Fire Response Training</h1>
            <p><strong>When Seconds Count, Training Saves Lives</strong></p>
            <div class="mission-critical-info">
                <p><strong>Why This Matters:</strong> Ship fires claim lives and vessels because traditional training can't replicate the chaos, time pressure, and complex decision-making of real emergencies. This AI-powered system bridges that gap.</p>
                <p><strong>Who Benefits:</strong> Naval personnel, merchant mariners, coast guard, maritime academies, and anyone responsible for shipboard safety in environments where escape routes are limited and mistakes are fatal.</p>
                <p><strong>The Edge:</strong> Experience realistic fire scenarios with AI-powered feedback, practice critical decisions without real-world consequences, and build the muscle memory that saves ships and crews.</p>
            </div>
        </div>

        <div class="critical-stats">
            <div class="stat-item">
                <div class="stat-number">90%</div>
                <div class="stat-label">of shipboard fatalities occur during the first 10 minutes of a fire</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">$180M</div>
                <div class="stat-label">USS Bonhomme Richard fire loss - preventable with faster response</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">5 min</div>
                <div class="stat-label">critical decision window before fire becomes uncontrollable</div>
            </div>
        </div>

        <div id="modeSelection" class="training-modes">
            <div class="mode-card" onclick="startScenarioMode()">
                <div class="mode-icon">üîç</div>
                <div class="mode-title">Scenario Analysis</div>
                <div class="mode-description">
                    <strong>Predict Fire Outcomes Before They Happen</strong><br>
                    Experience the same scenarios that have challenged real crews: electrical fires in engine rooms, galley blazes spreading to berthing, fuel leaks igniting in confined spaces. Our AI has learned from thousands of fire incidents to predict what happens next based on your decisions.
                </div>
                <ul class="mode-features">
                    <li>Real incident-based scenarios</li>
                    <li>AI predicts fire spread patterns</li>
                    <li>Decision confidence scoring</li>
                    <li>Learn from mistakes without casualties</li>
                </ul>
                <div class="mode-badge">AI + Real Incidents</div>
            </div>

            <div class="mode-card" onclick="startAssessmentMode()">
                <div class="mode-icon">üìã</div>
                <div class="mode-title">DCA Assessment</div>
                <div class="mode-description">
                    <strong>Test Your Skills Under Pressure</strong><br>
                    When smoke fills the compartment and seconds matter, can you identify the fire class, select the right suppression agent, and coordinate your team? This AI-powered assessment puts you in command during critical moments that separate competent sailors from heroes.
                </div>
                <ul class="mode-features">
                    <li>Military-grade scenario realism</li>
                    <li>AI evaluates decisions</li>
                    <li>Time-pressure decision making</li>
                    <li>Performance tracking & improvement</li>
                </ul>
                <div class="mode-badge">AI-Powered Assessment</div>
            </div>
        </div>

        <div id="assessmentContent" class="training-content">
            <!-- Dynamic content will be loaded here -->
        </div>
    </div>

    <script>
        // Global Configuration (API keys removed for security)
        const HF_API_KEY = ''; // Add your API key for local testing
        const AI_FEEDBACK_ENABLED = false; // Disabled for deployment
        const USE_MOCK_DATA = true; // Use mock data for deployment

        // Global State
        let currentMode = 'selection';
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedAnswer = null;
        let assessmentQuestions = [];

        // Make functions globally accessible
        window.startScenarioMode = function() {
            console.log('Starting Scenario Mode');
            document.getElementById('modeSelection').style.display = 'none';
            document.getElementById('assessmentContent').classList.add('active');
            currentMode = 'scenario';
            showScenarioInterface();
        }

        window.startAssessmentMode = function() {
            console.log('Starting Assessment Mode');
            document.getElementById('modeSelection').style.display = 'none';
            document.getElementById('assessmentContent').classList.add('active');
            currentMode = 'assessment';
            initializeAssessment();
        }

        window.returnToMenu = function() {
            document.getElementById('modeSelection').style.display = 'grid';
            document.getElementById('assessmentContent').classList.remove('active');
            currentMode = 'selection';
        }

        // Scenario Mode Interface
        function showScenarioInterface() {
            const content = document.getElementById('assessmentContent');
            content.innerHTML = `
                <div class="scenario-interface">
                    <div class="scenario-header">
                        <h2>üîç Fire Scenario Analysis</h2>
                        <p>Experience realistic fire scenarios based on actual incidents. Make critical decisions and see how they affect fire progression.</p>
                        <button onclick="returnToMenu()" class="scenario-btn secondary">Back to Menu</button>
                        <button onclick="generateRandomScenario()" class="scenario-btn primary">Generate Scenario</button>
                    </div>
                    
                    <div id="scenarioDisplay">
                        <div class="scenario-preview">
                            <h3>üö® Ready for Fire Emergency Training</h3>
                            <p>Click "Generate Scenario" to begin a realistic fire emergency simulation. Each scenario is based on actual shipboard incidents and will test your decision-making under pressure.</p>
                            
                            <div class="scenario-types">
                                <h4>Scenario Types Available:</h4>
                                <ul>
                                    <li><strong>Engine Room Fires:</strong> Fuel and electrical emergencies in confined spaces</li>
                                    <li><strong>Galley Incidents:</strong> Class K cooking fires with ventilation spread</li>
                                    <li><strong>Berthing Area Emergencies:</strong> Electrical fires threatening sleeping crew</li>
                                    <li><strong>Bridge Electronics:</strong> Critical system fires during navigation</li>
                                    <li><strong>Multi-Compartment Events:</strong> Fire spread scenarios requiring strategic decisions</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Generate random scenario
        window.generateRandomScenario = function() {
            const scenarios = [
                {
                    title: "Engine Room Fuel Fire",
                    location: "Main Engine Room",
                    fireType: "Class B - Fuel Oil",
                    situation: "High-pressure fuel line ruptures near hot manifold during normal operations. Immediate fire ignition with spray pattern creating multiple ignition points.",
                    initialDecision: "What is your immediate priority action?",
                    options: [
                        "Sound General Quarters and evacuate engine room",
                        "Attempt to isolate fuel source at main valve",
                        "Use water spray to cool adjacent equipment",
                        "Activate CO2 flooding system immediately"
                    ],
                    correct: 1,
                    explanation: "Fuel source isolation is critical - you cannot effectively suppress a fuel fire while the source continues feeding it. The isolation valve should be your immediate priority."
                },
                {
                    title: "Galley Deep Fryer Fire",
                    location: "Main Galley",
                    fireType: "Class K - Cooking Oil",
                    situation: "Deep fryer oil overheats during meal preparation and ignites. Fire is spreading to ventilation hood and threatening adjacent equipment.",
                    initialDecision: "Best suppression approach for this cooking fire:",
                    options: [
                        "Water spray to cool the burning oil",
                        "CO2 extinguisher to displace oxygen",
                        "Class K wet chemical suppression",
                        "Foam blanket to smother flames"
                    ],
                    correct: 2,
                    explanation: "Class K wet chemical suppression is specifically designed for cooking oil fires. It creates a foam blanket that cools the oil below ignition temperature and prevents re-ignition."
                },
                {
                    title: "Bridge Electronics Fire",
                    location: "Ship's Bridge",
                    fireType: "Class C - Electrical",
                    situation: "Navigation console sparks and ignites during night watch. Multiple electronic systems are failing and smoke is filling the bridge.",
                    initialDecision: "Priority action for electrical fire on bridge:",
                    options: [
                        "Use water fog to suppress quickly",
                        "Isolate electrical power and use CO2",
                        "Evacuate bridge immediately",
                        "Use foam suppression system"
                    ],
                    correct: 1,
                    explanation: "Electrical fires require power isolation first to prevent electrocution, then CO2 suppression which doesn't conduct electricity and won't damage sensitive electronics."
                }
            ];
            
            const scenario = scenarios[Math.floor(Math.random() * scenarios.length)];
            displayScenario(scenario);
        }

        // Display scenario
        function displayScenario(scenario) {
            const display = document.getElementById('scenarioDisplay');
            display.innerHTML = `
                <div class="scenario-display">
                    <div class="scenario-context">
                        <h3>üö® ${scenario.title}</h3>
                        <div class="scenario-details">
                            <div class="detail-item">
                                <span class="detail-label">Location:</span>
                                <span>${scenario.location}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Fire Type:</span>
                                <span>${scenario.fireType}</span>
                            </div>
                        </div>
                        <p><strong>Situation:</strong> ${scenario.situation}</p>
                    </div>
                    
                    <div class="response-options">
                        <h4>‚ö° ${scenario.initialDecision}</h4>
                        <div class="options-grid">
                            ${scenario.options.map((option, index) => `
                                <div class="response-option" onclick="selectScenarioAnswer(${index})">
                                    <input type="radio" name="scenarioChoice" value="${index}" id="option${index}">
                                    <label for="option${index}">${option}</label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="scenario-actions">
                        <button onclick="submitScenarioAnswer(${scenario.correct}, '${scenario.explanation}')" class="scenario-btn primary" id="submitScenarioBtn" disabled>Submit Decision</button>
                        <button onclick="generateRandomScenario()" class="scenario-btn secondary">Try Different Scenario</button>
                    </div>
                </div>
            `;
        }

        // Select scenario answer
        window.selectScenarioAnswer = function(index) {
            selectedAnswer = index;
            document.querySelectorAll('.response-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelectorAll('.response-option')[index].classList.add('selected');
            document.getElementById('submitScenarioBtn').disabled = false;
        }

        // Submit scenario answer
        window.submitScenarioAnswer = function(correctAnswer, explanation) {
            if (selectedAnswer === null) return;
            
            const isCorrect = selectedAnswer === correctAnswer;
            const display = document.getElementById('scenarioDisplay');
            
            display.innerHTML += `
                <div class="ai-analysis">
                    <h4>${isCorrect ? '‚úÖ Excellent Decision!' : '‚ùå Poor Tactical Choice'}</h4>
                    <div class="analysis-explanation">
                        <p><strong>Explanation:</strong> ${explanation}</p>
                        ${isCorrect ? 
                            '<p><strong>Outcome:</strong> Your quick thinking and proper suppression agent selection contained the fire with minimal damage. Crew safety maintained.</p>' :
                            '<p><strong>Outcome:</strong> Poor suppression choice led to fire escalation. In a real scenario, this could result in injuries and vessel loss.</p>'
                        }
                    </div>
                </div>
            `;
        }

        // Assessment Mode Functions
        function initializeAssessment() {
            assessmentQuestions = getAssessmentQuestions();
            currentQuestionIndex = 0;
            score = 0;
            selectedAnswer = null;
            showAssessmentInterface();
        }

        function showAssessmentInterface() {
            const content = document.getElementById('assessmentContent');
            content.innerHTML = `
                <div class="assessment-interface">
                    <div class="assessment-header">
                        <h2>üìã DCA Fire Response Assessment</h2>
                        <p>Test your knowledge with realistic fire emergency scenarios. Each question is based on actual procedures and real-world incidents.</p>
                        <button onclick="returnToMenu()" class="assessment-btn secondary">Back to Menu</button>
                        <button onclick="startQuiz()" class="assessment-btn primary">Begin Assessment</button>
                    </div>
                    
                    <div id="quizArea" style="display: none;">
                        <!-- Questions will be loaded here -->
                    </div>
                </div>
            `;
        }

        // Start the quiz
        window.startQuiz = function() {
            document.querySelector('.assessment-header button').style.display = 'none';
            document.getElementById('quizArea').style.display = 'block';
            showQuestion();
        }

        // Get assessment questions
        function getAssessmentQuestions() {
            return [
                {
                    question: "Engine room fire reported with heavy smoke. What is your first action as DCA?",
                    options: [
                        "Send investigation team to assess situation",
                        "Sound General Quarters immediately",
                        "Activate CO2 flooding system",
                        "Call Coast Guard for assistance"
                    ],
                    correct: 1,
                    explanation: "General Quarters must be sounded immediately to ensure maximum crew response and establish proper command structure for fire fighting."
                },
                {
                    question: "Galley deep fryer fire spreads to ventilation system. What suppression agent should be used?",
                    options: [
                        "Water spray to cool burning oil",
                        "CO2 to displace oxygen",
                        "Class K wet chemical system",
                        "Foam to smother flames"
                    ],
                    correct: 2,
                    explanation: "Class K wet chemical suppression is specifically designed for cooking oil fires and prevents re-ignition by cooling oil below auto-ignition temperature."
                },
                {
                    question: "Electrical fire in bridge navigation equipment during restricted visibility. Priority action?",
                    options: [
                        "Use water fog for quick suppression",
                        "Isolate power and use CO2 suppression",
                        "Evacuate bridge immediately",
                        "Continue navigation, fight fire later"
                    ],
                    correct: 1,
                    explanation: "Electrical fires require power isolation to prevent electrocution, followed by CO2 which doesn't conduct electricity or damage electronics."
                },
                {
                    question: "Multiple compartment fire with limited crew. What is your strategic priority?",
                    options: [
                        "Fight all fires simultaneously",
                        "Focus on largest fire first",
                        "Prevent spread to critical systems",
                        "Abandon ship preparation"
                    ],
                    correct: 2,
                    explanation: "With limited resources, preventing fire spread to critical systems (propulsion, power, life safety) takes priority over saving already burning spaces."
                },
                {
                    question: "Fuel oil fire in engine room with crew trapped. Immediate action?",
                    options: [
                        "Activate fixed CO2 system",
                        "Personnel rescue first, then suppression",
                        "Isolate fuel source immediately",
                        "Use water spray to create escape path"
                    ],
                    correct: 1,
                    explanation: "Life safety always takes priority. Personnel must be rescued before any suppression action that could endanger trapped crew members."
                }
            ];
        }

        // Show current question
        function showQuestion() {
            if (currentQuestionIndex >= assessmentQuestions.length) {
                showFinalResults();
                return;
            }

            const question = assessmentQuestions[currentQuestionIndex];
            const quizArea = document.getElementById('quizArea');
            
            quizArea.innerHTML = `
                <div class="question-container">
                    <div class="question-header">
                        <h3>Question ${currentQuestionIndex + 1} of ${assessmentQuestions.length}</h3>
                    </div>
                    
                    <div class="question-text">
                        <p>${question.question}</p>
                    </div>
                    
                    <div class="answer-options">
                        ${question.options.map((option, index) => `
                            <button class="answer-option" onclick="selectAnswer(${index})">
                                <span class="option-letter">${String.fromCharCode(65 + index)}</span>
                                <span class="option-text">${option}</span>
                            </button>
                        `).join('')}
                    </div>
                    
                    <div class="question-controls">
                        <button onclick="submitAnswer()" class="assessment-btn primary" id="submitBtn" disabled>Submit Answer</button>
                        ${currentQuestionIndex > 0 ? '<button onclick="previousQuestion()" class="assessment-btn secondary">Previous</button>' : ''}
                    </div>
                </div>
            `;
        }

        // Select answer
        window.selectAnswer = function(index) {
            selectedAnswer = index;
            document.querySelectorAll('.answer-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelectorAll('.answer-option')[index].classList.add('selected');
            document.getElementById('submitBtn').disabled = false;
        }

        // Submit answer
        window.submitAnswer = function() {
            if (selectedAnswer === null) return;
            
            const question = assessmentQuestions[currentQuestionIndex];
            const isCorrect = selectedAnswer === question.correct;
            
            if (isCorrect) score++;
            
            showAnswerFeedback(question, isCorrect);
        }

        // Show answer feedback
        function showAnswerFeedback(question, isCorrect) {
            const quizArea = document.getElementById('quizArea');
            
            quizArea.innerHTML = `
                <div class="question-container">
                    <div class="feedback-result ${isCorrect ? 'correct' : 'incorrect'}">
                        <h3>${isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect'}</h3>
                    </div>
                    
                    <div class="correct-answer">
                        <h4>Correct Answer:</h4>
                        <p><strong>${String.fromCharCode(65 + question.correct)}:</strong> ${question.options[question.correct]}</p>
                    </div>
                    
                    <div class="explanation">
                        <h4>Explanation:</h4>
                        <p>${question.explanation}</p>
                    </div>
                    
                    <div class="question-controls">
                        <button onclick="nextQuestion()" class="assessment-btn primary">
                            ${currentQuestionIndex < assessmentQuestions.length - 1 ? 'Next Question' : 'View Results'}
                        </button>
                    </div>
                </div>
            `;
        }

        // Next question
        window.nextQuestion = function() {
            currentQuestionIndex++;
            selectedAnswer = null;
            showQuestion();
        }

        // Previous question
        window.previousQuestion = function() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                selectedAnswer = null;
                showQuestion();
            }
        }

        // Show final results
        function showFinalResults() {
            const percentage = Math.round((score / assessmentQuestions.length) * 100);
            const quizArea = document.getElementById('quizArea');
            
            let performanceLevel = '';
            if (percentage >= 90) performanceLevel = 'Expert Level';
            else if (percentage >= 75) performanceLevel = 'Proficient';
            else if (percentage >= 60) performanceLevel = 'Developing';
            else performanceLevel = 'Needs Improvement';
            
            quizArea.innerHTML = `
                <div class="results-card">
                    <h2>üéØ Assessment Complete!</h2>
                    <div class="score-display">${percentage}%</div>
                    <div class="score-breakdown">
                        <p>${score} out of ${assessmentQuestions.length} correct</p>
                        <p><strong>Performance Level: ${performanceLevel}</strong></p>
                    </div>
                    
                    <div class="feedback-message">
                        ${percentage >= 80 ? 
                            'Excellent performance! You demonstrate strong understanding of fire response procedures and tactical decision-making.' :
                            percentage >= 60 ?
                            'Good foundation with room for improvement. Review fire classification and suppression procedures.' :
                            'Additional training recommended. Focus on fire fundamentals and emergency response procedures.'
                        }
                    </div>
                    
                    <div class="results-actions">
                        <button onclick="initializeAssessment()" class="assessment-btn secondary">Retake Assessment</button>
                        <button onclick="returnToMenu()" class="assessment-btn primary">Return to Menu</button>
                    </div>
                </div>
            `;
        }

        // Initialize feedback integration if available
        if (window.startDCAFeedbackSession) {
            console.log('DCA Feedback Integration Available');
        } else {
            console.log('Running in standalone mode');
        }
    </script>
</body>
</html>